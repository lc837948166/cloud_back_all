"use strict";(self["webpackChunkkfront"]=self["webpackChunkkfront"]||[]).push([[170],{84170:function(e,t,l){l.r(t),l.d(t,{default:function(){return n}});var m=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vmarea"},[t("el-col",{attrs:{span:10,offset:0}},[t("p",{staticStyle:{"font-size":"25px","font-weight":"600","margin-bottom":"20px"}},[e._v(" 模版列表 ")])]),t("el-col",{attrs:{span:2,offset:12}},[t("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"medium",round:"",plain:""},on:{click:e.openCreateVMtem}},[e._v("新增模版 ")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.vmtemdata.slice((e.curpage-1)*e.pagesize,e.curpage*e.pagesize),"empty-text":"暂无日志","header-cell-style":{background:"#00b8a9",color:"#fff"}}},[t("el-table-column",{attrs:{width:"100",type:"index",label:"序号"}}),t("el-table-column",{attrs:{sortable:"",label:"模版名称",prop:"name"}}),t("el-table-column",{attrs:{sortable:"",label:"内存大小(G)",prop:"memory"}}),t("el-table-column",{attrs:{sortable:"",label:"处理器个数",prop:"cpuNum"}}),t("el-table-column",{attrs:{sortable:"",label:"操作系统类型",prop:"OStype"}}),t("el-table-column",{attrs:{sortable:"",label:"镜像名称",prop:"ImgName"}}),t("el-table-column",{attrs:{sortable:"",label:"网络类型",prop:"nettype"}}),t("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(l.$index,l.row)}}},[e._v("删除")]),t("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(t){return e.edit(l.row)}}},[e._v("修改")]),t("el-tooltip",{attrs:{content:"以该模版创建虚拟机",placement:"top"}},[t("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return e.build(l.row)}}},[e._v("创建")])],1)]}}])})],1),0!=e.vmtemdata.length?t("div",{staticStyle:{"margin-top":"30px"}},[t("el-pagination",{attrs:{"current-page":e.curpage,"page-sizes":[10,20,30,40,50],"page-size":e.pagesize,layout:"sizes, total, prev, pager, next, jumper",total:e.totalvmtem,background:""},on:{"update:currentPage":function(t){e.curpage=t},"update:current-page":function(t){e.curpage=t},"update:pageSize":function(t){e.pagesize=t},"update:page-size":function(t){e.pagesize=t}}})],1):e._e(),t("el-dialog",{attrs:{title:"添加模版",visible:e.createvmtemvisible},on:{"update:visible":function(t){e.createvmtemvisible=t}}},[t("el-form",{ref:"vmtem_form",attrs:{"label-position":"top","label-width":"80px",model:e.vmtem_form,"status-icon":!0,rules:e.vmtem_rules}},[t("el-row",{attrs:{gutter:30}},[t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"模版名称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入模版名称"},model:{value:e.vmtem_form.name,callback:function(t){e.$set(e.vmtem_form,"name",t)},expression:"vmtem_form.name"}})],1)],1),t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"内存大小",prop:"memory"}},[t("el-input",{attrs:{placeholder:"请输入内存大小(单位G)",clearables:""},on:{blur:function(t){return e.validMemory("vmtem_form")}},model:{value:e.vmtem_form.memory,callback:function(t){e.$set(e.vmtem_form,"memory",t)},expression:"vmtem_form.memory"}})],1)],1)],1),t("el-row",{attrs:{gutter:30}},[t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"处理器个数",prop:"cpuNum"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择处理器个数"},model:{value:e.vmtem_form.cpuNum,callback:function(t){e.$set(e.vmtem_form,"cpuNum",t)},expression:"vmtem_form.cpuNum"}},e._l(e.cpuNum_options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"操作系统类型",prop:"OStype"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择操作系统类型"},model:{value:e.vmtem_form.OStype,callback:function(t){e.$set(e.vmtem_form,"OStype",t)},expression:"vmtem_form.OStype"}},e._l(e.OStype_options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-row",{attrs:{gutter:30}},[t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"虚拟机镜像,#仅支持qcow2格式",prop:"ImgName"}},[t("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择虚拟机镜像"},on:{"visible-change":e.nsremote},model:{value:e.vmtem_form.ImgName,callback:function(t){e.$set(e.vmtem_form,"ImgName",t)},expression:"vmtem_form.ImgName"}},e._l(e.images,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"网络类型",prop:"nettype"}},[t("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择创建虚拟机的网络类型"},model:{value:e.vmtem_form.nettype,callback:function(t){e.$set(e.vmtem_form,"nettype",t)},expression:"vmtem_form.nettype"}},e._l(e.nettype_options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("div",{staticClass:"cp-sbm-area",staticStyle:{"margin-left":"450px","margin-top":"20px"}},[t("el-button",{attrs:{round:""},on:{click:function(t){return e.resetForm("vmtem_form")}}},[e._v("重置")]),t("el-button",{attrs:{round:"",type:"primary"},on:{click:function(t){return e.vmtem_sumbit("vmtem_form")}}},[e._v("确认 ")])],1)],1)],1),t("el-dialog",{attrs:{title:"修改模版",visible:e.editvmtemvisible},on:{"update:visible":function(t){e.editvmtemvisible=t}}},[t("el-form",{ref:"editvmtem_form",attrs:{"label-position":"top","label-width":"80px",model:e.editvmtem_form,"status-icon":!0,rules:e.vmtem_rules}},[t("el-row",{attrs:{gutter:30}},[t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"模版名称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入模版名称"},on:{blur:function(t){return e.validName("editvmtem_form")}},model:{value:e.editvmtem_form.name,callback:function(t){e.$set(e.editvmtem_form,"name",t)},expression:"editvmtem_form.name"}})],1)],1),t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"内存大小",prop:"memory"}},[t("el-input",{attrs:{placeholder:"请输入内存大小(单位G)",clearables:""},on:{blur:function(t){return e.validMemory("editvmtem_form")}},model:{value:e.editvmtem_form.memory,callback:function(t){e.$set(e.editvmtem_form,"memory",t)},expression:"editvmtem_form.memory"}})],1)],1)],1),t("el-row",{attrs:{gutter:30}},[t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"处理器个数",prop:"cpuNum"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择处理器个数"},model:{value:e.editvmtem_form.cpuNum,callback:function(t){e.$set(e.editvmtem_form,"cpuNum",t)},expression:"editvmtem_form.cpuNum"}},e._l(e.cpuNum_options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"操作系统类型",prop:"OStype"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择操作系统类型"},model:{value:e.editvmtem_form.OStype,callback:function(t){e.$set(e.editvmtem_form,"OStype",t)},expression:"editvmtem_form.OStype"}},e._l(e.OStype_options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-row",{attrs:{gutter:30}},[t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"虚拟机镜像,#仅支持qcow2格式",prop:"ImgName"}},[t("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择虚拟机镜像"},on:{"visible-change":e.nsremote},model:{value:e.editvmtem_form.ImgName,callback:function(t){e.$set(e.editvmtem_form,"ImgName",t)},expression:"editvmtem_form.ImgName"}},e._l(e.images,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"网络类型",prop:"nettype"}},[t("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择创建虚拟机的网络类型"},model:{value:e.editvmtem_form.nettype,callback:function(t){e.$set(e.editvmtem_form,"nettype",t)},expression:"editvmtem_form.nettype"}},e._l(e.nettype_options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("div",{staticClass:"cp-sbm-area",staticStyle:{"margin-left":"450px","margin-top":"20px"}},[t("el-button",{attrs:{round:""},on:{click:function(t){return e.resetForm("editvmtem_form")}}},[e._v("重置")]),t("el-button",{attrs:{round:"",type:"primary"},on:{click:function(t){return e.editvmtem_sumbit("editvmtem_form")}}},[e._v("确认 ")])],1)],1)],1),t("el-dialog",{attrs:{title:"创建虚拟机",visible:e.buildvmtemvisible},on:{"update:visible":function(t){e.buildvmtemvisible=t}}},[t("el-form",{ref:"buildvmtem_form",attrs:{"label-position":"top","label-width":"50px",model:e.buildvmtem_form,"status-icon":!0}},[t("el-row",{attrs:{gutter:30}},[t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"请输入虚拟机名称",prop:"vmname"}},[t("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"请输入虚拟机名称"},on:{blur:function(t){return e.validName("buildvmtem_form")}},model:{value:e.buildvmtem_form.vmname,callback:function(t){e.$set(e.buildvmtem_form,"vmname",t)},expression:"buildvmtem_form.vmname"}})],1)],1),t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"节点",prop:"node"}},[t("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择创建虚拟机所在宿主机节点"},model:{value:e.buildvmtem_form.node,callback:function(t){e.$set(e.buildvmtem_form,"node",t)},expression:"buildvmtem_form.node"}},e._l(e.node_options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-row",{attrs:{gutter:30}},[t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"模版名称",prop:"name"}},[t("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"请输入模版名称",disabled:""},model:{value:e.buildvmtem_form.name,callback:function(t){e.$set(e.buildvmtem_form,"name",t)},expression:"buildvmtem_form.name"}})],1)],1),t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"内存大小",prop:"memory"}},[t("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"请输入内存大小(单位G)",clearables:"",disabled:""},on:{blur:function(t){return e.validMemory("editvmtem_form")}},model:{value:e.buildvmtem_form.memory,callback:function(t){e.$set(e.buildvmtem_form,"memory",t)},expression:"buildvmtem_form.memory"}})],1)],1)],1),t("el-row",{attrs:{gutter:30}},[t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"处理器个数",prop:"cpuNum"}},[t("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择处理器个数",disabled:""},model:{value:e.buildvmtem_form.cpuNum,callback:function(t){e.$set(e.buildvmtem_form,"cpuNum",t)},expression:"buildvmtem_form.cpuNum"}},e._l(e.cpuNum_options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"操作系统类型",prop:"OStype"}},[t("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择操作系统类型",disabled:""},model:{value:e.buildvmtem_form.OStype,callback:function(t){e.$set(e.buildvmtem_form,"OStype",t)},expression:"buildvmtem_form.OStype"}},e._l(e.OStype_options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:""}})})),1)],1)],1)],1),t("el-row",{attrs:{gutter:30}},[t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"虚拟机镜像,#仅支持qcow2格式",prop:"ImgName"}},[t("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择虚拟机镜像",disabled:""},on:{"visible-change":e.nsremote},model:{value:e.buildvmtem_form.ImgName,callback:function(t){e.$set(e.buildvmtem_form,"ImgName",t)},expression:"buildvmtem_form.ImgName"}},e._l(e.images,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12,offset:0}},[t("el-form-item",{attrs:{label:"网络类型",prop:"nettype"}},[t("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择创建虚拟机的网络类型",disabled:""},model:{value:e.buildvmtem_form.nettype,callback:function(t){e.$set(e.buildvmtem_form,"nettype",t)},expression:"buildvmtem_form.nettype"}},e._l(e.nettype_options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("div",{staticClass:"cp-sbm-area",staticStyle:{"margin-left":"450px","margin-top":"20px"}},[t("el-button",{attrs:{round:"",type:"primary"},on:{click:function(t){return e.buildvmtem_sumbit("buildvmtem_form")}}},[e._v("立即创建 ")])],1)],1)],1)],1)},a=[],o=(l(70560),l(36797),{name:"VMLogList",data(){return{baseurl:"http://39.98.124.97:8080",curpage:1,totalvmtem:0,pagesize:10,createvmtemvisible:!1,editvmtemvisible:!1,images:[],buildvmtemvisible:!1,vmtemdata:[],cpuNum_options:[{value:"2",label:"2"},{value:"4",label:"4"},{value:"6",label:"6"},{value:"8",label:"8"},{value:"10",label:"10"},{value:"12",label:"12"}],OStype_options:[{value:"X86",label:"X86"},{value:"ARM",label:"ARM"}],nettype_options:[{label:"bridge",value:"bridge"},{label:"nat",value:"nat"}],node_options:[{label:"云节点:39.98.124.97",value:"192.168.194.178"},{label:"端节点1:192.168.194.45",value:"192.168.194.45"},{label:"端节点2:192.168.194.164",value:"192.168.194.164"}],vmtem_form:{name:"",memory:"",cpuNum:"",OStype:""},editvmtem_form:{id:"",name:"",memory:"",cpuNum:"",OStype:"",ImgName:"",nettype:""},buildvmtem_form:{vmname:"",name:"",memory:"",cpuNum:"",OStype:"",ImgName:"",nettype:"",node:""},vmtem_rules:{vmname:[{required:!0,message:"请输入虚拟机名称",trigger:"blur"}],OStype:[{required:!0,message:"请选择操作系统类型",trigger:"change"}],cpuNum:[{required:!0,message:"请选择处理器个数",trigger:"change"}],memory:[{required:!0,message:"请输入内存大小",trigger:"blur"}]}}},mounted(){this.getVMTem()},methods:{getVMTem(){this.$axios.get(this.baseurl+"/Template/selectAll").then((e=>{e.data.success?(this.vmtemdata=e.data.content,this.totalvmtem=e.data.content.length):alert(e.data.msg)})).catch((e=>{alert(e),console.log("err::::"+e)}))},validName(e){"buildvmtem_form"===e&&this.buildvmtem_form.name.includes(".")&&this.$notify.error({message:"虚拟机名字不能包括特殊字符"})},buildvmtem_sumbit(e){this.$refs[e].validate((e=>{if(!e)return console.log("表单验证不通过"),!1;this.buildvmvisible=!1,this.$axios.get("http://"+this.buildvmtem_form.node+":8080/Template/addVirtual?ImgName="+this.buildvmtem_form.ImgName+"&name="+this.buildvmtem_form.vmname+"&memory="+this.buildvmtem_form.memory+"&cpuNum="+this.buildvmtem_form.cpuNum+"&OStype="+this.buildvmtem_form.OStype+"&nettype="+this.buildvmtem_form.nettype+"&serverip="+this.buildvmtem_form.node).then((e=>{this.$notify.success({title:"创建成功",message:"虚拟机 "+this.buildvmtem_form.name+" 创建成功！",position:"bottom-right",duration:6e3}),this.getVMList()})).catch((e=>{this.$notify.error({title:"创建失败",message:e,position:"bottom-right",duration:6e3})}))}))},validMemory(e){const t=/^[1-9]\d*(\.\d+)?$/;"vmtem_form"!==e||t.test(this.vmtem_form.memory)||this.$notify.error({message:"请输入正数"}),"editvmtem_form"!==e||t.test(this.editvmtem_form.memory)||this.$notify.error({message:"请输入正数"})},vmtem_sumbit(e){this.$refs[e].validate((e=>{if(!e)return console.log("表单验证不通过"),!1;this.$axios({method:"post",url:this.baseurl+"/Template/insert",data:this.vmtem_form,headers:{"Content-Type":"application/json"}}).then((e=>{!1===e.data.success?this.$notify.error({title:"创建失败",message:e.data.msg,position:"bottom-right"}):(this.$notify.success({title:"完成通知",message:"模版"+this.vmtem_form.name+" 创建成功",position:"bottom-right"}),this.getVMTem())}),(e=>{console.log(e),this.$notify.error({title:"创建失败",message:"请检查网络连接设置",position:"bottom-right"})})),this.createvmtemvisible=!1}))},nsremote(){this.$axios.get(this.baseurl+"/Images/imgList").then((e=>{let t=[];for(let l=0;l<e.data.content.length;l++){let m={};m["label"]=e.data.content[l].name,m["value"]=e.data.content[l].name,t.push(m)}this.images=t})).catch((e=>{console.log("errors",e)}))},editvmtem_sumbit(e){this.$refs[e].validate((e=>{if(!e)return console.log("表单验证不通过"),!1;this.$axios({method:"post",url:this.baseurl+"/Template/update",data:this.editvmtem_form,headers:{"Content-Type":"application/json"}}).then((e=>{!1===e.data.success?this.$notify.error({title:"修改失败",message:e.data.msg,position:"bottom-right"}):(this.$notify.success({title:"修改通知",message:"模版"+this.editvmtem_form.name+" 修改成功",position:"bottom-right"}),this.getVMTem())}),(e=>{console.log(e),this.$notify.error({title:"修改失败",message:"请检查网络连接设置",position:"bottom-right"})})),this.editvmtemvisible=!1}))},openCreateVMtem(){this.createvmtemvisible=!0},handleDelete(e,t){this.$confirm("您确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$axios.delete(this.baseurl+"/Template/delete/"+t.id).then((e=>{const t=e.data;t.success?(this.$message.success("删除成功！"),this.getVMTem()):this.$message.success("删除失败！")}))})).catch((()=>{this.$message({type:"info",message:"已取消"})}))},edit(e){this.editvmtem_form.id=e.id,this.editvmtem_form.name=e.name,this.editvmtem_form.memory=e.memory,this.editvmtem_form.cpuNum=e.cpuNum,this.editvmtem_form.OStype=e.OStype,this.editvmtem_form.ImgName=e.ImgName,this.editvmtem_form.nettype=e.nettype,this.editvmtemvisible=!0},build(e){this.buildvmtem_form.name=e.name,this.buildvmtem_form.memory=e.memory,this.buildvmtem_form.cpuNum=e.cpuNum,this.buildvmtem_form.OStype=e.OStype,this.buildvmtem_form.ImgName=e.ImgName,this.buildvmtem_form.nettype=e.nettype,this.buildvmtemvisible=!0},resetForm(e){this.$refs[e].resetFields()},sucupload(e,t,l){"ok"===e?(this.$notify.success({title:"创建成功",message:"虚拟机 "+this.buildvmtem_form.name+" 创建成功！",position:"bottom-right",duration:6e3}),this.$router.push("/vmlist")):this.$notify.error({title:"创建失败",message:e,position:"bottom-right",duration:6e3})},errupload(e,t,l){this.$notify.error({title:"创建失败",message:JSON.parse(e.message).message,position:"bottom-right",duration:6e3})}}}),r=o,i=l(1001),s=(0,i.Z)(r,m,a,!1,null,null,null),n=s.exports}}]);
//# sourceMappingURL=170.840bc8d1.js.map
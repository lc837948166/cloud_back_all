"use strict";(self["webpackChunkkfront"]=self["webpackChunkkfront"]||[]).push([[35],{77035:function(t,e,a){a.r(e),a.d(e,{default:function(){return u}});var l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"podarea"},[e("el-row",{attrs:{gutter:0}},[e("el-col",{attrs:{span:"3",offset:0}},[e("p",{staticStyle:{"font-size":"25px","font-weight":"600","margin-bottom":"20px"}},[t._v(" 操作日志列表 ")])]),e("el-col",{attrs:{span:"3"}},[e("el-select",{staticStyle:{"margin-bottom":"5px"},attrs:{placeholder:"请选择操作模块",clearable:""},model:{value:t.searchmodule,callback:function(e){t.searchmodule=e},expression:"searchmodule"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-col",{attrs:{span:"3",offset:""}},[e("el-select",{staticStyle:{"margin-bottom":"5px"},attrs:{placeholder:"请求状态",clearable:""},model:{value:t.searchstate,callback:function(e){t.searchstate=e},expression:"searchstate"}},t._l(t.stateoptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-col",{attrs:{span:"4",offset:""}},[e("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择开始时间"},model:{value:t.starttime,callback:function(e){t.starttime=e},expression:"starttime"}})],1),e("el-col",{attrs:{span:"3",offset:""}},[e("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择结束时间"},model:{value:t.endtime,callback:function(e){t.endtime=e},expression:"endtime"}})],1),e("el-col",{attrs:{span:"2",offset:"1"}},[e("el-button",{attrs:{round:"",plain:"",type:"primary"},on:{click:t.getLogList}},[t._v("查询")])],1),e("el-col",{attrs:{span:"3"}},[e("p",{staticStyle:{"font-size":"20px",color:"#08c0b9","font-weight":"600","margin-top":"5px","margin-bottom":"40px"}},[t._v(" 日志保存时间:"+t._s(t.savedays)+"天 ")])]),e("el-col",{attrs:{span:2}},[e("el-button",{attrs:{round:"",plain:"",type:"primary"},on:{click:t.downloadFile}},[t._v("下载任务日志")])],1)],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.logdata.slice((t.curpage-1)*t.pagesize,t.curpage*t.pagesize),"empty-text":"暂无操作日志","header-cell-style":{background:"#00b8a9",color:"#fff"}}},[e("el-table-column",{attrs:{type:"index",label:"序号"}}),e("el-table-column",{attrs:{sortable:"",label:"操作模块",prop:"operationModule"}}),e("el-table-column",{attrs:{sortable:"",label:"操作事件",prop:"operationEvents"}}),e("el-table-column",{attrs:{sortable:"",label:"请求URL",prop:"operationUrl"}}),e("el-table-column",{attrs:{sortable:"",label:"请求数据",prop:"operationData"}}),e("el-table-column",{attrs:{sortable:"",label:"异常输出",prop:"operationResult"}}),e("el-table-column",{attrs:{sortable:"",label:"操作时间",prop:"AddTime"}}),e("el-table-column",{attrs:{sortable:"",label:"请求状态",prop:"OperationStatus"},scopedSlots:t._u([{key:"default",fn:function(a){return[!1===a.row.operationStatus?e("el-tag",{attrs:{type:"warning"}},[t._v("失败")]):!0===a.row.operationStatus?e("el-tag",{attrs:{type:"success"}},[t._v("成功")]):t._e()]}}])}),e("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.handleDelete(a.$index,a.row)}}},[t._v("Delete")])]}}])})],1),0!=t.logdata.length?e("div",{staticStyle:{"margin-top":"30px"}},[e("el-pagination",{attrs:{"current-page":t.curpage,"page-sizes":[10,20,30,40,50],"page-size":t.pagesize,layout:"sizes, total, prev, pager, next, jumper",total:t.totallog,background:""},on:{"update:currentPage":function(e){t.curpage=e},"update:current-page":function(e){t.curpage=e},"update:pageSize":function(e){t.pagesize=e},"update:page-size":function(e){t.pagesize=e}}})],1):t._e()],1)},s=[],o=(a(98858),a(61318),a(33228),a(36797)),n=a.n(o),r={name:"LogList",data(){return{baseurl:"http://39.98.124.97:8080",logdata:[],pageNum:1,curpage:1,totallog:0,savedays:"",pagesize:10,starttime:"",endtime:"",searchmodule:"",searchstate:"",options:[{value:"容器管理",label:"容器管理"},{value:"虚拟机管理",label:"虚拟机管理"},{value:"日志管理",label:"日志管理"},{value:"镜像管理",label:"镜像管理"},{value:"存储管理",label:"存储管理"},{value:"指标管理",label:"指标管理"},{value:"物理机管理",label:"物理机管理"}],stateoptions:[{value:1,label:"成功"},{value:0,label:"失败"}]}},mounted(){this.getLogList(),this.getSaveDays()},methods:{getSaveDays(){this.$axios.get(this.baseurl+"/log/getSaveDays").then((t=>{this.savedays=t.data.content})).catch((t=>{}))},getLogList(){this.starttime=n()(this.starttime).format("YYYY-MM-DD HH:mm:ss"),this.endtime=n()(this.endtime).format("YYYY-MM-DD HH:mm:ss"),"Invalid date"===this.starttime&&(this.starttime=""),"Invalid date"===this.endtime&&(this.endtime=""),console.log(this.starttime),this.$axios.get(this.baseurl+"/log/getLogList",{params:{operationModule:this.searchmodule,operationStatus:this.searchstate,starttime:this.starttime,endtime:this.endtime}}).then((t=>{this.logdata=t.data.content,console.log(t.data.content),this.totallog=t.data.content.length})).catch((t=>{console.log("errors",t)}))},downloadFile(){fetch("http://39.98.124.97:8080/downloadLog",{method:"GET",headers:{"Content-Type":"application/json"}}).then((t=>(console.log(t),t.blob()))).then((t=>{const e=window.URL.createObjectURL(new Blob([t])),a=document.createElement("a");a.href=e,a.setAttribute("download","TaskLog.txt"),document.body.appendChild(a),a.click(),a.parentNode.removeChild(a)})).catch((t=>{console.error("下载文件时出错:",t)}))},handleDelete(t,e){this.$confirm("您确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$axios.delete(this.baseurl+"/log/deleteLog/"+e.id).then((t=>{const e=t.data;e.success?(this.$message.success("删除成功！"),this.getLogList()):this.$message.success("删除失败！")}))})).catch((()=>{this.$message({type:"info",message:"已取消"})}))}}},i=r,c=a(1001),p=(0,c.Z)(i,l,s,!1,null,null,null),u=p.exports}}]);
//# sourceMappingURL=35.ead4795a.js.map
"use strict";(self["webpackChunkkfront"]=self["webpackChunkkfront"]||[]).push([[761],{48761:function(t,e,a){a.r(e),a.d(e,{default:function(){return m}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"vmarea"},[e("el-col",{attrs:{span:10,offset:0}},[e("p",{staticStyle:{"font-size":"25px","font-weight":"600","margin-bottom":"20px"}},[t._v(" 虚拟机镜像列表 ")])]),e("el-col",{attrs:{span:2,offset:12}},[e("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"medium",round:"",plain:""},on:{click:t.openCreateVMima}},[t._v("添加镜像 ")])],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.vmimadata.slice((t.curpage-1)*t.pagesize,t.curpage*t.pagesize),"empty-text":"暂无镜像","header-cell-style":{background:"#00b8a9",color:"#fff"}}},[e("el-table-column",{attrs:{type:"index",label:"序号",width:"200"}}),e("el-table-column",{attrs:{sortable:"",label:"镜像名称",prop:"name"}}),e("el-table-column",{attrs:{sortable:"",label:"镜像大小(MiB)",prop:"size"}}),e("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.handleDelete(a.$index,a.row)}}},[t._v("删除")])]}}])})],1),0!=t.vmimadata.length?e("div",{staticStyle:{"margin-top":"30px"}},[e("el-pagination",{attrs:{"current-page":t.curpage,"page-sizes":[10,20,30,40,50],"page-size":t.pagesize,layout:"sizes, total, prev, pager, next, jumper",total:t.totalvmima,background:""},on:{"update:currentPage":function(e){t.curpage=e},"update:current-page":function(e){t.curpage=e},"update:pageSize":function(e){t.pagesize=e},"update:page-size":function(e){t.pagesize=e}}})],1):t._e(),e("el-dialog",{attrs:{title:"添加镜像",visible:t.createvmimavisible},on:{"update:visible":function(e){t.createvmimavisible=e}}},[e("el-form",{ref:"vmima_form",attrs:{"label-position":"top","label-width":"80px",model:t.vmima_form,"status-icon":!0}},[e("el-form-item",{attrs:{label:"虚拟机映像文件",prop:"vm_iso"}},[e("el-upload",{ref:"upload",staticClass:"upload-demo",staticStyle:{width:"30%"},attrs:{drag:"",action:t.baseurl+"/Images/addImg",multiple:!1,data:t.vmima_form,accept:".iso","auto-upload":!1,limit:1,"before-upload":t.handleBeforeUpload,"on-success":t.sucupload,"on-error":t.errupload}},[e("i",{staticClass:"el-icon-upload"}),e("div",{staticClass:"el-upload__text"},[t._v(" 将文件拖到此处，或"),e("em",[t._v("点击上传")])]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" *只能上传.iso/.qcow2/.img文件 ")])])],1),e("div",{staticClass:"cp-sbm-area",staticStyle:{"margin-left":"450px","margin-top":"20px"}},[e("el-button",{attrs:{round:"",type:"primary"},on:{click:function(e){return t.addvmima_sumbit("vmima_form")}}},[t._v("确认 ")])],1)],1)],1)],1)},s=[],l=(a(36797),{name:"VMImaList",data(){return{baseurl:"http://39.98.124.97:8080",curpage:1,totalvmima:0,pagesize:10,createvmimavisible:!1,editvmimavisible:!1,buildvmimavisible:!1,vmimadata:[],vmima_form:[]}},mounted(){this.getVMIma()},methods:{getVMIma(){this.$axios.get(this.baseurl+"/Images/imgList").then((t=>{t.data.success?(this.vmimadata=t.data.content,this.totalvmima=t.data.content.length):alert(t.data.msg)})).catch((t=>{alert(t),console.log("err::::"+t)}))},openCreateVMima(){this.createvmimavisible=!0},handleDelete(t,e){this.$confirm("您确定删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$axios.delete(this.baseurl+"/Images/deleteImg/"+e.name).then((t=>{const e=t.data;e.success?(this.$message.success("删除成功！"),this.getVMIma()):this.$message.success("删除失败！")}))})).catch((()=>{this.$message({type:"info",message:"已取消"})}))},handleBeforeUpload(t){var e=t.name.substring(t.name.lastIndexOf(".")+1);return e},sucupload(t,e,a){"ok"===t?this.$notify.success({title:"添加成功",message:"镜像添加成功！",position:"bottom-right",duration:6e3}):this.$notify.error({title:"添加失败",message:t,position:"bottom-right",duration:6e3})},errupload(t,e,a){this.$notify.error({title:"添加失败",message:"镜像添加失败",position:"bottom-right",duration:6e3})},addvmima_sumbit(t){if(0===this.$refs.upload.uploadFiles.length)return this.$message.error("请上传一个文件！"),!1;this.$refs.upload.submit()}}}),o=l,r=a(1001),n=(0,r.Z)(o,i,s,!1,null,null,null),m=n.exports}}]);
//# sourceMappingURL=761.f8309b88.js.map